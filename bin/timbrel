#!/usr/bin/env ruby

def usage
  puts "USAGE: #{File.basename($0)} vm_name vagrant_action"
  abort
end

usage unless ARGV[0] && ARGV[1]

require 'timbrel'
vm_dir = File.expand_path TIMBREL_CONFIG['vm_dir']
vm_name = ARGV[0]
vagrant_action = ARGV[1..-1].join(' ')

Dir.chdir(vm_dir) do
  puts "+ #{`pwd`}"
  Dir.chdir(vm_name) do
    puts "+ #{`pwd`}"
    cmd = "vagrant #{vagrant_action}"
    puts "++ #{cmd}"
    system cmd
  end
end
